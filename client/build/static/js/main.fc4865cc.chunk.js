(this["webpackJsonpair-chat"]=this["webpackJsonpair-chat"]||[]).push([[0],{107:function(e,t,c){},130:function(e,t,c){},131:function(e,t,c){"use strict";c.r(t);var a=c(1),n=c.n(a),s=c(29),r=c.n(s),i=c(2),o=c(18),l=c(5),j=c(68),d=c.n(j),u=(c(107),c(0)),b=function(e){var t=e.children;return Object(u.jsx)("div",{className:"app",children:t})},h=c(6),O=c.n(h),m=function(e){return{type:"SET_LOGGED_IN",payload:e}},p=function(e){return{type:"SET_LOGGED_OUT",payload:e}},v=function(e){return{type:"SET_LOADING",payload:e}},x=function(e){return{type:"SHOW_PROFILE",payload:e}},f=function(){return Object(u.jsx)("div",{className:"preloader",children:Object(u.jsxs)("p",{children:[Object(u.jsxs)("span",{children:[Object(u.jsx)("i",{className:"far fa-comment-alt"})," "]})," ","Loading ..."]})})};O.a.defaults.withCredentials=!0;var g=function(e){var t=e.children,c=Object(i.c)((function(e){return e.auth.pageLoading})),n=Object(i.b)();return Object(a.useEffect)((function(){O.a.get("".concat("https://air-chat-bd.herokuapp.com","/auth/get-login"),{withCredentials:!0}).then((function(e){var t=e.data.data.user;n(m(t)),n(v(!1))})).catch((function(e){n(p({})),n(v(!1))}))}),[n]),c?Object(u.jsx)(f,{}):t},N=function(e){var t=e.children;return Object(u.jsx)("div",{className:"container",children:t})},y=c(3),E=c(42),S=["children"],_=["children"],w=function(e){var t=e.children,c=Object(E.a)(e,S),a=Object(i.c)((function(e){return e.auth.isLoggedIn}));return Object(u.jsx)(l.b,Object(y.a)(Object(y.a)({},c),{},{render:function(e){var c=e.location;return a?t:Object(u.jsx)(l.a,{to:{pathname:"/login",state:{from:c}}})}}))},C=function(e){var t=e.children,c=Object(E.a)(e,_),a=Object(i.c)((function(e){return e.auth.isLoggedIn}));return Object(u.jsx)(l.b,Object(y.a)(Object(y.a)({},c),{},{render:function(e){var c=e.location;return a?Object(u.jsx)(l.a,{to:{pathname:"/home",state:{from:c}}}):t}}))},I=c(8),T=function(e){return{type:"SET_ACTIVE_CONVERSATION",payload:e}},k=function(e){return{type:"RESET_NEW_MESSAGE",payload:e}},L=function(e){var t=e.receiver,c=Object(a.useState)(!1),n=Object(I.a)(c,2),s=n[0],r=n[1];return Object(a.useEffect)((function(){Z.on("receiver-typing",(function(e){t._id===e.userId&&r(e.status)}))}),[]),Object(u.jsxs)("div",{className:"chat-nav",children:[Object(u.jsx)("div",{className:"avatar",children:Object(u.jsx)("img",{src:"".concat("https://air-chat-bd.herokuapp.com","/avaters/").concat(t.photoUrl),alt:"user"})}),Object(u.jsxs)("div",{className:"user-info",children:[Object(u.jsx)("p",{children:t.name}),s?Object(u.jsx)("small",{children:"typing..."}):Object(u.jsx)("small",{children:"online"})]})]})},A=function(){var e=Object(i.b)(),t=Object(a.useRef)(null),c=Object(a.useState)(!1),n=Object(I.a)(c,2),s=n[0],r=n[1],o=Object(a.useState)(""),l=Object(I.a)(o,2),j=l[0],d=l[1],b=Object(i.c)((function(e){return e.chat})),h=b.activeConversation,m=b.receiver,p=b.messages,v=b.newMessages,x=Object(i.c)((function(e){return e.auth.loggedInUser})),f=Object(a.useRef)(null),g=function(){f.current.scrollIntoView({behavior:"smooth"})};Object(a.useEffect)((function(){g(),Z.on("message-sent",(function(t){t.conversation===h._id&&e({type:"SET_NEW_MESSAGE",payload:t})}))}),[]),Object(a.useEffect)((function(){g()}),[v]);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(L,{receiver:m,typing:s}),Object(u.jsxs)("div",{className:"chat-body",children:[Object(u.jsxs)("div",{className:"message-container",children:[p.map((function(e){return Object(u.jsx)("div",{className:"".concat(e.sender===m._id?"messages":"messages message-right"),children:Object(u.jsx)("p",{children:e.text})},e._id)})),v.map((function(e){return Object(u.jsx)("div",{className:"".concat(e.sender===m._id?"messages":"messages message-right"),children:Object(u.jsx)("p",{children:e.text})},e._id)}))]}),Object(u.jsx)("div",{ref:f})]}),Object(u.jsx)("div",{className:"chat-footer",children:Object(u.jsx)("form",{style:{width:"100%"},onSubmit:function(e){if(e.preventDefault(),j.replace(/\s/g,"")){var t={conversation:h._id,receiver:m._id,text:j};O.a.post("/message/new-message",t).then((function(e){d("")})).catch((function(e){return console.log(e)}))}},children:Object(u.jsxs)("div",{className:"chat-form",children:[Object(u.jsx)("input",{onChange:function(e){d(e.target.value),s||(Z.emit("typing",{userId:x.id,status:!0}),r(!0)),t.current&&clearTimeout(t.current),t.current=setTimeout((function(){Z.emit("typing",{userId:x.id,status:!1}),r(!1)}),2e3)},type:"text",name:"",id:"",value:j}),Object(u.jsx)("button",{type:"submit",children:"Send"})]})})})]})},R=function(){return Object(u.jsxs)("div",{className:"chat-start",children:[Object(u.jsx)("div",{className:"chat-icon",children:Object(u.jsx)("i",{className:"far fa-comment-alt"})}),Object(u.jsx)("p",{children:"Start Conversation"})]})},U=function(){var e=Object(i.c)((function(e){return e.chat})).chatOpen;return Object(u.jsx)("div",{className:"content",children:e?Object(u.jsx)(A,{}):Object(u.jsx)(R,{})})},G=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.auth.loggedInUser}));return Object(u.jsxs)("div",{className:"sidebar",children:[Object(u.jsx)("div",{className:"close-button",children:Object(u.jsx)("i",{className:"fas fa-times",onClick:function(){return e(x())}})}),Object(u.jsxs)("div",{className:"profile-content",children:[Object(u.jsxs)("div",{className:"profile-details",children:[Object(u.jsx)("div",{className:"avatar",children:Object(u.jsx)("img",{src:"".concat("https://air-chat-bd.herokuapp.com","/avaters/").concat(t.photoUrl),alt:"user"})}),Object(u.jsx)("p",{className:"profile-name",children:t.name}),Object(u.jsx)("p",{className:"profile-mail",children:t.email})]}),Object(u.jsx)("div",{className:"profile-footer",children:Object(u.jsx)("button",{className:"btn-signout",onClick:function(){O.a.delete("".concat("https://air-chat-bd.herokuapp.com","/auth/logout")).then((function(t){e(p({}))})).catch((function(e){return console.log(e)}))},children:"Sign out"})})]})]})},M=function(e){var t=e.user;return Object(u.jsx)("div",{className:"".concat(t.isOnline?"online":""," avatar"),children:Object(u.jsx)("img",{src:"".concat("https://air-chat-bd.herokuapp.com","/avaters/").concat(t.photoUrl),alt:"user"})})},D=c(69),F=c.n(D),P=function(e){var t,c,a,n=e.conversation,s=Object(i.b)();return Object(u.jsxs)("div",{className:"chat-single",onClick:function(){return e=n.currentReceiver._id,void O.a.post("".concat("https://air-chat-bd.herokuapp.com","/message/new-conversation"),{participant_id:e}).then((function(e){var t=e.data.data,c=t.receiver,a=t.messages,n=t.conversation;s(k([])),s(T({receiver:c,messages:a,conversation:n}))})).catch((function(e){return console.log(e)}));var e},children:[Object(u.jsx)(M,{user:n.currentReceiver}),Object(u.jsxs)("div",{className:"chat-info",children:[Object(u.jsxs)("h3",{children:[n.currentReceiver.name,Object(u.jsx)("span",{style:{float:"right",fontSize:"10px"},children:n.message&&Object(u.jsx)(F.a,{date:n.message.createdAt,fromNow:!0})})," "]}),Object(u.jsxs)("p",{children:[(null===(t=n.message)||void 0===t?void 0:t.text.length)>20?(null===(c=n.message)||void 0===c?void 0:c.text.substring(0,20))+"...":null===(a=n.message)||void 0===a?void 0:a.text," "]})]})]})},V=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.chat})).allConversations;return Object(a.useEffect)((function(){O.a.get("".concat("https://air-chat-bd.herokuapp.com","/message/get-all-conversation")).then((function(t){var c=t.data.data.msg;e({type:"SET_ALL_CONVERSATION",payload:c})})).catch((function(e){return console.log(e.response)}))}),[]),Object(u.jsxs)("div",{className:"chat-history",children:[Object(u.jsx)("h3",{className:"sidebar-title",children:"Chat"}),t.map((function(e){return e.message&&Object(u.jsx)(P,{conversation:e},e.currentReceiver._id)}))]})},W=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.auth.loggedInUser}));return Object(u.jsxs)("div",{className:"sidebar-nav",children:[Object(u.jsx)("div",{className:"avatar online",onClick:function(){return e(x())},children:Object(u.jsx)("img",{src:"".concat("https://air-chat-bd.herokuapp.com","/avaters/").concat(t.photoUrl),alt:"user"})}),Object(u.jsx)("div",{className:"search",children:Object(u.jsxs)("div",{className:"input-group",children:[Object(u.jsx)("i",{className:"fa fa-search icon"}),Object(u.jsx)("input",{className:"input-field",type:"text",placeholder:"search"})]})})]})},H=function(){var e=Object(i.b)(),t=Object(a.useState)([]),c=Object(I.a)(t,2),n=c[0],s=c[1];Object(a.useEffect)((function(){O.a.get("".concat("https://air-chat-bd.herokuapp.com","/user/get-all-users")).then((function(e){var t=e.data.data.user;s(t)})).catch((function(e){return console.log(e)}))}),[e]);return Object(u.jsxs)("div",{className:"sidebar",children:[Object(u.jsx)(W,{}),Object(u.jsxs)("div",{className:"sidebar-content",children:[Object(u.jsx)(V,{}),Object(u.jsxs)("div",{className:"chat-history",children:[Object(u.jsx)("h3",{className:"sidebar-title",children:"Users"}),n.map((function(t){return Object(u.jsxs)("div",{className:"chat-single",onClick:function(){return c=t._id,void O.a.post("".concat("https://air-chat-bd.herokuapp.com","/message/new-conversation"),{participant_id:c}).then((function(t){var c=t.data.data,a=c.receiver,n=c.messages,s=c.conversation;e(k([])),e(T({receiver:a,messages:n,conversation:s}))})).catch((function(e){return console.log(e)}));var c},children:[Object(u.jsx)(M,{user:t}),Object(u.jsxs)("div",{className:"chat-info",children:[Object(u.jsxs)("h3",{children:[t.name,Object(u.jsx)("span",{style:{float:"right",fontSize:"10px"},children:"12:22 pm"})," "]}),Object(u.jsx)("p",{children:t.email})]})]},t._id)}))]})]})]})},z=function(){var e=Object(i.c)((function(e){return e.auth.showProfile}));return Object(u.jsxs)(u.Fragment,{children:[e?Object(u.jsx)(G,{}):Object(u.jsx)(H,{}),Object(u.jsx)(U,{})]})},J=c(22),B=c.n(J),q=c(32),K=c(21),Q=c(33),X=function(){var e=Object(a.useState)(),t=Object(I.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)({email:"",password:""}),r=Object(I.a)(s,2),l=r[0],j=r[1],d=Object(i.b)(),b=function(e){j(Object(y.a)(Object(y.a)({},l),{},Object(K.a)({},e.target.name,e.target.value)))},h=function(){var e=Object(q.a)(B.a.mark((function e(t){var c,a,s;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.a.post("".concat("https://air-chat-bd.herokuapp.com","/auth/login"),l);case 4:c=e.sent,a=c.data.data.user,d(m(a)),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),s=e.t0.response.data.errors,console.log(s),n(Object(Q.decoratErr)(s));case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"sidebar"}),Object(u.jsx)("div",{className:"chat-start",children:Object(u.jsxs)("form",{className:"form-signup",onSubmit:h,children:[Object(u.jsx)("h3",{children:"Sign In"}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsx)("input",{name:"email",className:"input-primary",type:"email",placeholder:"Email",onChange:b})}),Object(u.jsx)("small",{className:"input-error",children:null===c||void 0===c?void 0:c.email}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsx)("input",{name:"password",className:"input-primary",type:"password",placeholder:"Password",onChange:b})}),Object(u.jsx)("small",{className:"input-error",children:null===c||void 0===c?void 0:c.password}),Object(u.jsx)("small",{className:"input-error",children:null===c||void 0===c?void 0:c.common}),Object(u.jsxs)("div",{className:"d-flex mt-20",children:[Object(u.jsx)("input",{className:"button-secondary",type:"reset",value:"Cancel"}),Object(u.jsx)("input",{className:"button-primary",type:"submit",value:"Login"})]}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsxs)("div",{className:"form-footer",children:["Dont hav an account? ",Object(u.jsx)(o.b,{to:"/register",children:"Sign up"})," "]})})]})})]})},Y=function(){var e=Object(a.useState)({}),t=Object(I.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)(null),r=Object(I.a)(s,2),l=r[0],j=r[1],d=Object(a.useState)({}),b=Object(I.a)(d,2),h=b[0],p=b[1],v=Object(i.b)(),x=function(e){n(Object(y.a)(Object(y.a)({},c),{},Object(K.a)({},e.target.name,e.target.value)))},f=function(){var e=Object(q.a)(B.a.mark((function e(t){var a,n,s,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=new FormData,l&&a.append("photoUrl",l,l.name),Object.keys(c).forEach((function(e){a.append(e,c[e])})),e.prev=4,e.next=7,O.a.post("".concat("https://air-chat-bd.herokuapp.com","/auth/signup"),a);case 7:n=e.sent,console.log(n),s=n.data.data.user,v(m(s)),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(4),r=e.t0.response.data.errors,console.log(r),p(Object(Q.decoratErr)(r));case 18:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"sidebar"}),Object(u.jsx)("div",{className:"chat-start",children:Object(u.jsxs)("form",{className:"form-signup",onSubmit:f,children:[Object(u.jsx)("h3",{children:"Sign Up"}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsx)("input",{name:"name",className:"input-primary",type:"text",placeholder:"Full Name",onChange:x})}),Object(u.jsx)("small",{className:"input-error",children:null===h||void 0===h?void 0:h.name}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsx)("input",{name:"email",className:"input-primary",type:"email",placeholder:"Email",onChange:x})}),Object(u.jsx)("small",{className:"input-error",children:null===h||void 0===h?void 0:h.email}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsx)("input",{name:"password",className:"input-primary",type:"password",placeholder:"Password",onChange:x})}),Object(u.jsx)("small",{className:"input-error",children:null===h||void 0===h?void 0:h.password}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsxs)("select",{name:"gender",className:"input-primary",onChange:x,children:[Object(u.jsx)("option",{value:"",children:"Gender"}),Object(u.jsx)("option",{value:"Male",children:"Male"}),Object(u.jsx)("option",{value:"Female",children:"Female"}),Object(u.jsx)("option",{value:"Other",children:"Other"})]})}),Object(u.jsx)("small",{className:"input-error",children:null===h||void 0===h?void 0:h.gender}),Object(u.jsxs)("div",{className:"d-flex custom-file-group",children:[Object(u.jsx)("label",{htmlFor:"file-upload",className:"custom-file-upload",children:"Select Photo"}),Object(u.jsx)("input",{name:"avatars",id:"file-upload",className:"input-primary",type:"file",placeholder:"Select photo",onChange:function(e){j(e.target.files[0])}})]}),Object(u.jsx)("small",{className:"input-error",children:null===h||void 0===h?void 0:h.photoUrl}),Object(u.jsxs)("div",{className:"d-flex mt-20",children:[Object(u.jsx)("input",{className:"button-secondary",type:"reset",value:"Clear"}),Object(u.jsx)("input",{className:"button-primary",type:"submit",value:"Signup"})]}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsxs)("div",{className:"form-footer",children:["Have an account? ",Object(u.jsx)(o.b,{to:"/login",children:"Sign in"})," "]})})]})})]})},Z=d()("/");var $=function(){return Object(u.jsx)(o.a,{children:Object(u.jsx)(N,{children:Object(u.jsx)(b,{children:Object(u.jsx)(g,{children:Object(u.jsxs)(l.d,{children:[Object(u.jsx)(C,{path:"/login",children:Object(u.jsx)(X,{})}),Object(u.jsx)(C,{path:"/register",children:Object(u.jsx)(Y,{})}),Object(u.jsx)(w,{path:"/",children:Object(u.jsx)(z,{})})]})})})})})},ee=(c(130),c(41)),te={pageLoading:!0,isLoggedIn:!1,loggedInUser:{},showProfile:!1},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOGGED_IN":var c=Object(y.a)(Object(y.a)({},e),{},{isLoggedIn:!0,loggedInUser:t.payload});return c;case"SET_LOGGED_OUT":var a=Object(y.a)(Object(y.a)({},e),{},{isLoggedIn:!1,loggedInUser:{}});return a;case"SET_LOADING":var n=Object(y.a)(Object(y.a)({},e),{},{pageLoading:t.payload});return n;case"SHOW_PROFILE":var s=Object(y.a)(Object(y.a)({},e),{},{showProfile:!e.showProfile});return s;default:return e}},ae=c(70),ne={chatOpen:!1,allConversations:[],activeConversation:{},receiver:{},messages:[],newMessages:[]},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ALL_CONVERSATION":var c=Object(y.a)(Object(y.a)({},e),{},{allConversations:t.payload});return c;case"SET_ACTIVE_CONVERSATION":var a=Object(y.a)(Object(y.a)({},e),{},{activeConversation:t.payload.conversation,receiver:t.payload.receiver,messages:t.payload.messages,chatOpen:!0,newMessages:[]});return a;case"RESET_CONVERSATION":var n=Object(y.a)(Object(y.a)({},e),{},{activeConversation:{},receiver:{},messages:{},chatOpen:!1,newMessages:[]});return n;case"SET_NEW_MESSAGE":var s=Object(y.a)(Object(y.a)({},e),{},{newMessages:[].concat(Object(ae.a)(e.newMessages),[t.payload])});return s;case"RESET_NEW_MESSAGE":var r=Object(y.a)(Object(y.a)({},e),{},{newMessages:[]});return r;default:return e}},re=Object(ee.a)({auth:ce,chat:se}),ie=Object(ee.b)(re);r.a.render(Object(u.jsx)(n.a.StrictMode,{children:Object(u.jsx)(i.a,{store:ie,children:Object(u.jsx)($,{})})}),document.getElementById("root"))},33:function(e,t){e.exports={decoratErr:function(e){var t={};return Object.keys(e).forEach((function(c){return t[c]=e[c].msg})),t}}}},[[131,1,2]]]);
//# sourceMappingURL=main.fc4865cc.chunk.js.map